<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<!-- saved from url=(0051)http://demo1.mycodes.net/denglu/HTML5_yonghudenglu/ -->
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>æ¹˜æ½­å¤§å­¦è€ƒç ”èµ„è®¯ç½‘æ³¨å†Œ</title>
  <meta name="description" content="particles.js is a lightweight JavaScript library for creating particles.">
  <meta name="author" content="Vincent Garreau">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <!-- General CSS Files -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.8.2/css/all.min.css">
  
  <!-- CSS Libraries -->
  <link rel="stylesheet" type="text/css" href="../resources/admin/register/css/selectric.css"/>

  <!-- Template CSS -->
  <link rel="stylesheet" type="text/css" href="../resources/admin/register/css/styles.css"/>
  <link rel="stylesheet" type="text/css" href="../resources/admin/register/css/components.css"/>
<body>
<div id="app">
    <section class="section">
      <div class="container mt-5">
        <div class="row">
          <div class="col-12 col-sm-10 offset-sm-1 col-md-8 offset-md-2 col-lg-8 offset-lg-2 col-xl-8 offset-xl-2">
           
			<div class="card card-primary">
              <div class="card-header">
                <h4>æ³¨å†Œ</h4>
              </div>

              <div class="card-body">
                <form action="javascript:void(0);" method="POST" class="needs-validation" novalidate="">
					
					<div class="row">
					  <div class="form-group col-lg-6 col-sm-12 col-xs-12">
					    <label for="username" class="d-block">ç”¨æˆ·å</label>
					    <input id="username" type="text" class="form-control" data-indicator="pwindicator" name="username" required>
					    <div class="invalid-feedback">
					      è¯·å¡«å†™ç”¨æˆ·å(8~10ä½)
					    </div>
					  </div>
					  <div class="form-group col-lg-6 col-sm-12 col-xs-12">
					    <label for="nickname" class="d-block">æ˜µç§°</label>
					    <input id="nickname" type="text" class="form-control" name="nickname" required>
					    <div class="invalid-feedback">
					      è¯·å¡«å†™æ˜µç§°(2~8ä½)
					    </div>
					  </div>
					</div>
					
                    <div class="row">
                      <div class="form-group col-lg-6 col-sm-12 col-xs-12">
                      <label for="email">é‚®ç®±</label>
                      <div class="input-group">
                        <input type="text" id="email" class="form-control col-7" required>
                        <select class="custom-select input-group-append col-5" id="email_postfix" required style="border-top-right-radius: .25rem;
                          border-bottom-right-radius: .25rem;">
                          <option value="@gmail.com">@gmail.com</option>
                          <option value="@qq.com">@qq.com</option>
                          <option value="@163.com" selected="selected">@163.com</option>
                          <option value="@126.com">@126.com</option>
                          <option value="@outlook.com">@outlook.com</option>
                          <option value="@yeah.net">@yeah.net</option>
                          <option value="@foxmail.com">@foxmail.com</option>
                          <option value="@sina.com">@sina.com</option>
                        </select>
                        <div class="invalid-feedback">
                 		         é‚®ç®±æ ¼å¼é”™è¯¯
                        </div>
                      </div>
                    </div>
                     <div class="form-group col-lg-6 col-sm-12 col-xs-12">
                      <label for="email">é‚®ç®±éªŒè¯ç </label>
                      <div class="input-group mb-3">
                        <input id="email_code" type="text" class="form-control" name="email_code" required>
                        <div class="input-group-append">
                          <button id="email_verify" class="btn btn-primary" type="button">è·å–éªŒè¯ç </button>
                        </div>
                      </div>
                      <div class="invalid-feedback">
                      		  è¯·å¡«å†™6ä½é‚®ç®±éªŒè¯ç 
                      </div>
                    </div>
                  </div>
                  
                  <div class="row">
                    <div class="form-group col-lg-6 col-sm-12 col-xs-12">
                      <label for="password" class="d-block">å¯†ç </label>
                      <input id="password" type="password" class="form-control pwstrength" data-indicator="pwindicator" name="password" required>
                      <div id="pwindicator" class="pwindicator">
                        <div class="bar"></div>
                        <div class="label"></div>
                      </div>
                      <div class="invalid-feedback">
                      		   å¯†ç å¿…é¡»åœ¨8~16ä½ä¹‹é—´
                      </div>
                    </div>
                    <div class="form-group col-lg-6 col-sm-12 col-xs-12">
                      <label for="repasswd" class="d-block">é‡å¤å¯†ç </label>
                      <input id="password_confirm" type="password" class="form-control" name="password_confirm" required>
                      <div class="invalid-feedback">
                       		 ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´
                      </div>
                    </div>
                  </div>

                  <div class="form-group">
                    <button id="register-confirm" class="btn btn-primary btn-lg btn-block">
                 		     æ³¨å†Œ
                    </button>
                  </div>
                  <div class="sk-rotating-plane"></div>
                </form>
                              </div>
            </div>
            <div class="mt-5 text-muted text-center">
            	    å·²ç»æœ‰è´¦å·äº†ï¼Ÿ <a href="/XtuGraduate/system/userlogin">é©¬ä¸Šç™»å½• ğŸ‘‰</a>
              </div>
            <div class="simple-footer">
				
            </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

<!-- General JS Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.4/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tooltip.js@1.3.2/dist/umd/tooltip.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery.nicescroll@3.7.6/jquery.nicescroll.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/moment@2.18.1/min/moment.min.js"></script>

  <!-- JS Libraies -->
  <script src="../resources/admin/register/js/jquery.pwstrength.min.js"></script>
  <script src="../resources/admin/register/js/jquery.selectric.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@7.25.6/dist/sweetalert2.all.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
  
<script type="text/javascript">
	function hasClass(elem, cls) {
	  cls = cls || '';
	  if (cls.replace(/\s/g, '').length == 0) return false; //å½“clsæ²¡æœ‰å‚æ•°æ—¶ï¼Œè¿”å›false
	  return new RegExp(' ' + cls + ' ').test(' ' + elem.className + ' ');
	}
	 
	function addClass(ele, cls) {
	  if (!hasClass(ele, cls)) {
	    ele.className = ele.className == '' ? cls : ele.className + ' ' + cls;
	  }
	}
	 
	function removeClass(ele, cls) {
	  if (hasClass(ele, cls)) {
	    var newClass = ' ' + ele.className.replace(/[\t\r\n]/g, '') + ' ';
	    while (newClass.indexOf(' ' + cls + ' ') >= 0) {
	      newClass = newClass.replace(' ' + cls + ' ', ' ');
	    }
	    ele.className = newClass.replace(/^\s+|\s+$/g, '');
	  }
	}
	$(".pwstrength").pwstrength({
    texts: ['å¾ˆå¼±', 'å¼±', 'ä¸€èˆ¬', 'å¼º', 'å¾ˆå¼º'] 
 	 });
	var wait = 60;
	function time(o) {
	      if (wait == 0) {
	        o.removeAttr("disabled");
	        o.text("è·å–éªŒè¯ç ");
	        wait = 60;
	      } else {
	        o.attr("disabled", "disabled");
	        o.text("é‡æ–°å‘é€(" + wait + ")");
	        wait--;
	        setTimeout(function () {
	            time(o)
	          },
	          1000)
	      }
	    }
		 $(function () {
				var flagUsername=false;
				var flagNickname=false;
		        var flagEmail=false;
		        var flagPass=false;
		        var flagPassConfirm=false;
		        var flagCode=false;
		        
		        var username,nickname,email,password,password_confirm,emailCode;
		        /*éªŒè¯ç”¨æˆ·å*/
		        $("#username").change(function(){
		        	username=$("#username").val();
		            if(username.length<8 || username.length>10){
		                $("#username").removeClass("form-control is-valid")
		                $("#username").addClass("form-control is-invalid");
		                flagUsername=false;
		            }else{
		                $("#username").removeClass("form-control is-invalid")
		                $("#username").addClass("form-control is-valid");
		                flagUsername=true;
		            }
		        })
		        /*éªŒè¯æ˜µç§°*/
		        $("#nickname").change(function(){
		        	nickname=$("#nickname").val();
		            if(nickname.length<2 || nickname.length>8){
		                $("#nickname").removeClass("form-control is-valid")
		                $("#nickname").addClass("form-control is-invalid");
		                flagNickname=false;
		            }else{
		                $("#nickname").removeClass("form-control is-invalid")
		                $("#nickname").addClass("form-control is-valid");
		                flagNickname=true;
		            }
		        })
		        /*éªŒè¯é‚®ç®±*/
		        $("#email").change(function(){
		        	email=$("#email").val()+$("#email_postfix").val();
		            if(!email.match(/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/)){
		                $("#email").removeClass("form-control is-valid")
		                $("#email").addClass("form-control is-invalid");
		                flagEmail=false;
		            }else{
		                $("#email").removeClass("form-control is-invalid")
		                $("#email").addClass("form-control is-valid");
		                flagEmail=true;
		            }
		        })
		        /*éªŒè¯å¯†ç */
		        $("#password").change(function(){
		        	password=$("#password").val();
		            if(password.length<8||password.length>16){
		                $("#password").removeClass("form-control is-valid")
		                $("#password").addClass("form-control is-invalid");
		                flagPass=false;
		            }else{
		                $("#password").removeClass("form-control is-invalid")
		                $("#password").addClass("form-control is-valid");
		                flagPass=true;
		            }
		        })
		        /*éªŒè¯ç¡®è®¤å¯†ç */
		        $("#password_confirm").change(function(){
		        	password_confirm=$("#password_confirm").val();
		            if(password_confirm != password){
		                $("#password_confirm").removeClass("form-control is-valid")
		                $("#password_confirm").addClass("form-control is-invalid");
		                flagPassConfirm=false;
		            }else{
		                $("#password_confirm").removeClass("form-control is-invalid")
		                $("#password_confirm").addClass("form-control is-valid");
		                flagPassConfirm=true;
		            }
		        })
		        /*éªŒè¯é‚®ç®±éªŒè¯ç */
		        $("#email_code").change(function(){
		        	emailCode=$("#email_code").val();
		            if(emailCode.length != 6){
		                $("#email_code").removeClass("form-control is-valid")
		                $("#email_code").addClass("form-control is-invalid");
		                flagCode=false;
		            }else{
		                $("#email_code").removeClass("form-control is-invalid")
		                $("#email_code").addClass("form-control is-valid");
		                flagCode=true;
		            }
		        })
		        /*å‘é€é‚®ç®±éªŒè¯ç */
		        $("#email_verify").click(function () {
			      time($("#email_verify"));
			      var email = $("#email").val()+$("#email_postfix").val();
			      if(flagEmail){
			    	  $.ajax({
			  	        type: "POST",
			  	        url: "sendEmail",
			  	        dataType: "json",
			  	        data: {
			  	          email: email
			  	        },
			  	        success: function (data) {
			  	          if (data.type == 'success') {
			  	            swal({
			  	              type: 'success',
			  	              title: 'å·²å‘é€éªŒè¯ç ',
			  	              showCloseButton: true,
			  	              text: 'éªŒè¯ç 15åˆ†é’Ÿå†…æœ‰æ•ˆï¼Œå¦‚é•¿æ—¶é—´æœªæ”¶åˆ°ï¼Œè¯·æŸ¥çœ‹é‚®ä»¶åƒåœ¾ç®±'
			  	            })
			  	          } else {
			  	            swal({
			  	              type: 'error',
			  	              title: 'å‘é€éªŒè¯ç å¤±è´¥',
			  	              showCloseButton: true,
			  	              text: data.msg
			  	            })
			  	          }
			  	        }
			  	      });
			      }
			      else{
			    	  swal({
			              type: 'error',
			              showCloseButton: true,
			              text: "é‚®ç®±æ ¼å¼é”™è¯¯"
			            })
			      }
			      
			    })
		        $("#register-confirm").click(function(){
		        	var flag = false;
		        	var username = $("#username").val();
		    		var nickname = $("#nickname").val();
		    		var email = $("#email").val()+$("#email_postfix").val();
		    		var emailCode = $("#email_code").val();
		    		var password = $("#password").val();
		            if(flagUsername&&flagNickname&&flagEmail&&flagPass&&flagPassConfirm&&flagCode){
		                flag = true;
		            }else{
		            	if(!flagUsername){
		                    $("#username").addClass("form-control is-invalid");
		                }
		            	if(!flagNickname){
		                    $("#nickname").addClass("form-control is-invalid");
		                }
		                if(!flagEmail){
		                    $("#email").addClass("form-control is-invalid");
		                }
		                if(!flagPass){
		                    $("#password").addClass("form-control is-invalid");
		                }
		                if(!flagPassConfirm){
		                    $("#password_confirm").addClass("form-control is-invalid");
		                }
		                if(!flagCode){
		                    $("#email_code").addClass("form-control is-invalid");
		                }
		                flag = false;
		            }
		            if(flag){
		            	$.ajax({
		        			url:'register',
		        			data:{username:username,password:password,nickname:nickname,email:email,emailCode:emailCode},
		        			type:'post',
		        			dataType:'json',
		        			success:function(data){
		        				if(data.type == 'success'){
		        					swal({
		        		                  type: 'success',
		        		                  title: 'æ³¨å†ŒæˆåŠŸ',
		        		                  showCloseButton: true,
		        					})
		        				}else{
		        					$('#register-confirm').removeClass("disabled")
		        	                $('#register-confirm').removeAttr("disabled")
		        	                //$("#code").val(code);
		        	                swal({
		        	                  type: 'error',
		        	                  title: 'æç¤º',
		        	                  showCloseButton: true,
		        	                  text: data.msg
		        	                })
		        				}
		        			}
		        		});
		            }
		            else{
		            	swal({
				              type: 'error',
				              showCloseButton: true,
				              text: "è¯·æ£€æŸ¥è¾“å…¥"
				            })
		            }
		        })
		    })
</script>
</body></html>